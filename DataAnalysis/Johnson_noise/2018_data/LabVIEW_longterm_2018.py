from __future__ import division
#import labrad
import numpy as np
from matplotlib import pyplot
import matplotlib
import lmfit
from scipy.interpolate import interp1d

def T_from_R(res):
    T_NTC = np.array([-40.0,
    -39.8,
    -39.6,
    -39.4,
    -39.2,
    -39.0,
    -38.8,
    -38.6,
    -38.4,
    -38.2,
    -38.0,
    -37.8,
    -37.6,
    -37.4,
    -37.2,
    -37.0,
    -36.8,
    -36.6,
    -36.4,
    -36.2,
    -36.0,
    -35.8,
    -35.6,
    -35.4,
    -35.2,
    -35.0,
    -34.8,
    -34.6,
    -34.4,
    -34.2,
    -34.0,
    -33.8,
    -33.6,
    -33.4,
    -33.2,
    -33.0,
    -32.8,
    -32.6,
    -32.4,
    -32.2,
    -32.0,
    -31.8,
    -31.6,
    -31.4,
    -31.2,
    -31.0,
    -30.8,
    -30.6,
    -30.4,
    -30.2,
    -30.0,
    -29.8,
    -29.6,
    -29.4,
    -29.2,
    -29.0,
    -28.8,
    -28.6,
    -28.4,
    -28.2,
    -28.0,
    -27.8,
    -27.6,
    -27.4,
    -27.2,
    -27.0,
    -26.8,
    -26.6,
    -26.4,
    -26.2,
    -26.0,
    -25.8,
    -25.6,
    -25.4,
    -25.2,
    -25.0,
    -24.8,
    -24.6,
    -24.4,
    -24.2,
    -24.0,
    -23.8,
    -23.6,
    -23.4,
    -23.2,
    -23.0,
    -22.8,
    -22.6,
    -22.4,
    -22.2,
    -22.0,
    -21.8,
    -21.6,
    -21.4,
    -21.2,
    -21.0,
    -20.8,
    -20.6,
    -20.4,
    -20.2,
    -20.0,
    -19.8,
    -19.6,
    -19.4,
    -19.2,
    -19.0,
    -18.8,
    -18.6,
    -18.4,
    -18.2,
    -18.0,
    -17.8,
    -17.6,
    -17.4,
    -17.2,
    -17.0,
    -16.8,
    -16.6,
    -16.4,
    -16.2,
    -16.0,
    -15.8,
    -15.6,
    -15.4,
    -15.2,
    -15.0,
    -14.8,
    -14.6,
    -14.4,
    -14.2,
    -14.0,
    -13.8,
    -13.6,
    -13.4,
    -13.2,
    -13.0,
    -12.8,
    -12.6,
    -12.4,
    -12.2,
    -12.0,
    -11.8,
    -11.6,
    -11.4,
    -11.2,
    -11.0,
    -10.8,
    -10.6,
    -10.4,
    -10.2,
    -10.0,
    -9.8,
    -9.6,
    -9.4,
    -9.2,
    -9.0,
    -8.8,
    -8.6,
    -8.4,
    -8.2,
    -8.0,
    -7.8,
    -7.6,
    -7.4,
    -7.2,
    -7.0,
    -6.8,
    -6.6,
    -6.4,
    -6.2,
    -6.0,
    -5.8,
    -5.6,
    -5.4,
    -5.2,
    -5.0,
    -4.8,
    -4.6,
    -4.4,
    -4.2,
    -4.0,
    -3.8,
    -3.6,
    -3.4,
    -3.2,
    -3.0,
    -2.8,
    -2.6,
    -2.4,
    -2.2,
    -2.0,
    -1.8,
    -1.6,
    -1.4,
    -1.2,
    -1.0,
    -0.8,
    -0.6,
    -0.4,
    -0.2,
    0.0,
    0.2,
    0.4,
    0.6,
    0.8,
    1.0,
    1.2,
    1.4,
    1.6,
    1.8,
    2.0,
    2.2,
    2.4,
    2.6,
    2.8,
    3.0,
    3.2,
    3.4,
    3.6,
    3.8,
    4.0,
    4.2,
    4.4,
    4.6,
    4.8,
    5.0,
    5.2,
    5.4,
    5.6,
    5.8,
    6.0,
    6.2,
    6.4,
    6.6,
    6.8,
    7.0,
    7.2,
    7.4,
    7.6,
    7.8,
    8.0,
    8.2,
    8.4,
    8.6,
    8.8,
    9.0,
    9.2,
    9.4,
    9.6,
    9.8,
    10.0,
    10.2,
    10.4,
    10.6,
    10.8,
    11.0,
    11.2,
    11.4,
    11.6,
    11.8,
    12.0,
    12.2,
    12.4,
    12.6,
    12.8,
    13.0,
    13.2,
    13.4,
    13.6,
    13.8,
    14.0,
    14.2,
    14.4,
    14.6,
    14.8,
    15.0,
    15.2,
    15.4,
    15.6,
    15.8,
    16.0,
    16.2,
    16.4,
    16.6,
    16.8,
    17.0,
    17.2,
    17.4,
    17.6,
    17.8,
    18.0,
    18.2,
    18.4,
    18.6,
    18.8,
    19.0,
    19.2,
    19.4,
    19.6,
    19.8,
    20.0,
    20.2,
    20.4,
    20.6,
    20.8,
    21.0,
    21.2,
    21.4,
    21.6,
    21.8,
    22.0,
    22.2,
    22.4,
    22.6,
    22.8,
    23.0,
    23.2,
    23.4,
    23.6,
    23.8,
    24.0,
    24.2,
    24.4,
    24.6,
    24.8,
    25.0,
    25.2,
    25.4,
    25.6,
    25.8,
    26.0,
    26.2,
    26.4,
    26.6,
    26.8,
    27.0,
    27.2,
    27.4,
    27.6,
    27.8,
    28.0,
    28.2,
    28.4,
    28.6,
    28.8,
    29.0,
    29.2,
    29.4,
    29.6,
    29.8,
    30.0,
    30.2,
    30.4,
    30.6,
    30.8,
    31.0,
    31.2,
    31.4,
    31.6,
    31.8,
    32.0,
    32.2,
    32.4,
    32.6,
    32.8,
    33.0,
    33.2,
    33.4,
    33.6,
    33.8,
    34.0,
    34.2,
    34.4,
    34.6,
    34.8,
    35.0,
    35.2,
    35.4,
    35.6,
    35.8,
    36.0,
    36.2,
    36.4,
    36.6,
    36.8,
    37.0,
    37.2,
    37.4,
    37.6,
    37.8,
    38.0,
    38.2,
    38.4,
    38.6,
    38.8,
    39.0,
    39.2,
    39.4,
    39.6,
    39.8,
    40.0,
    40.2,
    40.4,
    40.6,
    40.8,
    41.0,
    41.2,
    41.4,
    41.6,
    41.8,
    42.0,
    42.2,
    42.4,
    42.6,
    42.8,
    43.0,
    43.2,
    43.4,
    43.6,
    43.8,
    44.0,
    44.2,
    44.4,
    44.6,
    44.8,
    45.0,
    45.2,
    45.4,
    45.6,
    45.8,
    46.0,
    46.2,
    46.4,
    46.6,
    46.8,
    47.0,
    47.2,
    47.4,
    47.6,
    47.8,
    48.0,
    48.2,
    48.4,
    48.6,
    48.8,
    49.0,
    49.2,
    49.4,
    49.6,
    49.8,
    50.0,
    50.2,
    50.4,
    50.6,
    50.8,
    51.0,
    51.2,
    51.4,
    51.6,
    51.8,
    52.0,
    52.2,
    52.4,
    52.6,
    52.8,
    53.0,
    53.2,
    53.4,
    53.6,
    53.8,
    54.0,
    54.2,
    54.4,
    54.6,
    54.8,
    55.0,
    55.2,
    55.4,
    55.6,
    55.8,
    56.0,
    56.2,
    56.4,
    56.6,
    56.8,
    57.0,
    57.2,
    57.4,
    57.6,
    57.8,
    58.0,
    58.2,
    58.4,
    58.6,
    58.8,
    59.0,
    59.2,
    59.4,
    59.6,
    59.8,
    60.0,
    60.2,
    60.4,
    60.6,
    60.8,
    61.0,
    61.2,
    61.4,
    61.6,
    61.8,
    62.0,
    62.2,
    62.4,
    62.6,
    62.8,
    63.0,
    63.2,
    63.4,
    63.6,
    63.8,
    64.0,
    64.2,
    64.4,
    64.6,
    64.8,
    65.0,
    65.2,
    65.4,
    65.6,
    65.8,
    66.0,
    66.2,
    66.4,
    66.6,
    66.8,
    67.0,
    67.2,
    67.4,
    67.6,
    67.8,
    68.0,
    68.2,
    68.4,
    68.6,
    68.8,
    69.0,
    69.2,
    69.4,
    69.6,
    69.8,
    70.0,
    70.2,
    70.4,
    70.6,
    70.8,
    71.0,
    71.2,
    71.4,
    71.6,
    71.8,
    72.0,
    72.2,
    72.4,
    72.6,
    72.8,
    73.0,
    73.2,
    73.4,
    73.6,
    73.8,
    74.0,
    74.2,
    74.4,
    74.6,
    74.8,
    75.0,
    75.2,
    75.4,
    75.6,
    75.8,
    76.0,
    76.2,
    76.4,
    76.6,
    76.8,
    77.0,
    77.2,
    77.4,
    77.6,
    77.8,
    78.0,
    78.2,
    78.4,
    78.6,
    78.8,
    79.0,
    79.2,
    79.4,
    79.6,
    79.8,
    80.0,
    80.2,
    80.4,
    80.6,
    80.8,
    81.0,
    81.2,
    81.4,
    81.6,
    81.8,
    82.0,
    82.2,
    82.4,
    82.6,
    82.8,
    83.0,
    83.2,
    83.4,
    83.6,
    83.8,
    84.0,
    84.2,
    84.4,
    84.6,
    84.8,
    85.0,
    85.2,
    85.4,
    85.6,
    85.8,
    86.0,
    86.2,
    86.4,
    86.6,
    86.8,
    87.0,
    87.2,
    87.4,
    87.6,
    87.8,
    88.0,
    88.2,
    88.4,
    88.6,
    88.8,
    89.0,
    89.2,
    89.4,
    89.6,
    89.8,
    90.0,
    90.2,
    90.4,
    90.6,
    90.8,
    91.0,
    91.2,
    91.4,
    91.6,
    91.8,
    92.0,
    92.2,
    92.4,
    92.6,
    92.8,
    93.0,
    93.2,
    93.4,
    93.6,
    93.8,
    94.0,
    94.2,
    94.4,
    94.6,
    94.8,
    95.0,
    95.2,
    95.4,
    95.6,
    95.8,
    96.0,
    96.2,
    96.4,
    96.6,
    96.8,
    97.0,
    97.2,
    97.4,
    97.6,
    97.8,
    98.0,
    98.2,
    98.4,
    98.6,
    98.8,
    99.0,
    99.2,
    99.4,
    99.6,
    99.8,
    100.0,
    100.2,
    100.4,
    100.6,
    100.8,
    101.0,
    101.2,
    101.4,
    101.6,
    101.8,
    102.0,
    102.2,
    102.4,
    102.6,
    102.8,
    103.0,
    103.2,
    103.4,
    103.6,
    103.8,
    104.0,
    104.2,
    104.4,
    104.6,
    104.8,
    105.0,
    105.2,
    105.4,
    105.6,
    105.8,
    106.0,
    106.2,
    106.4,
    106.6,
    106.8,
    107.0,
    107.2,
    107.4,
    107.6,
    107.8,
    108.0,
    108.2,
    108.4,
    108.6,
    108.8,
    109.0,
    109.2,
    109.4,
    109.6,
    109.8,
    110.0,
    110.2,
    110.4,
    110.6,
    110.8,
    111.0,
    111.2,
    111.4,
    111.6,
    111.8,
    112.0,
    112.2,
    112.4,
    112.6,
    112.8,
    113.0,
    113.2,
    113.4,
    113.6,
    113.8,
    114.0,
    114.2,
    114.4,
    114.6,
    114.8,
    115.0,
    115.2,
    115.4,
    115.6,
    115.8,
    116.0,
    116.2,
    116.4,
    116.6,
    116.8,
    117.0,
    117.2,
    117.4,
    117.6,
    117.8,
    118.0,
    118.2,
    118.4,
    118.6,
    118.8,
    119.0,
    119.2,
    119.4,
    119.6,
    119.8,
    120.0,
    120.2,
    120.4,
    120.6,
    120.8,
    121.0,
    121.2,
    121.4,
    121.6,
    121.8,
    122.0,
    122.2,
    122.4,
    122.6,
    122.8,
    123.0,
    123.2,
    123.4,
    123.6,
    123.8,
    124.0,
    124.2,
    124.4,
    124.6,
    124.8,
    125.0])
    
    res_NTC = np.array([334274.4,
    329874.7,
    325538.8,
    321265.8,
    317054.7,
    312904.4,
    308814.1,
    304782.8,
    300809.5,
    296893.4,
    293033.6,
    289229.1,
    285479.2,
    281782.9,
    278139.4,
    274548.0,
    271007.8,
    267517.9,
    264077.7,
    260686.4,
    257343.1,
    254047.2,
    250798.0,
    247594.6,
    244436.5,
    241322.9,
    238253.1,
    235226.4,
    232242.2,
    229299.9,
    226398.8,
    223538.3,
    220717.7,
    217936.5,
    215194.00,
    212489.69,
    209822.96,
    207193.24,
    204599.98,
    202042.63,
    199520.64,
    197033.47,
    194580.61,
    192161.54,
    189775.75,
    187422.75,
    185102.03,
    182813.13,
    180555.55,
    178328.84,
    176132.54,
    173966.18,
    171829.33,
    169721.55,
    167642.41,
    165591.47,
    163568.34,
    161572.58,
    159603.80,
    157661.60,
    155745.60,
    153855.39,
    151990.61,
    150150.88,
    148335.83,
    146545.11,
    144778.35,
    143035.21,
    141315.34,
    139618.40,
    137944.05,
    136291.98,
    134661.85,
    133053.35,
    131466.17,
    129899.99,
    128354.51,
    126829.43,
    125324.47,
    123839.32,
    122373.70,
    120927.34,
    119499.95,
    118091.27,
    116701.03,
    115328.95,
    113974.79,
    112638.29,
    111319.19,
    110017.26,
    108732.23,
    107463.88,
    106211.96,
    104976.25,
    103756.51,
    102552.53,
    101364.06,
    100190.91,
    99032.85,
    97889.66,
    96761.15,
    95647.10,
    94547.31,
    93461.58,
    92389.72,
    91331.53,
    90286.81,
    89255.39,
    88237.08,
    87231.69,
    86239.05,
    85258.97,
    84291.29,
    83335.83,
    82392.43,
    81460.91,
    80541.11,
    79632.88,
    78736.04,
    77850.46,
    76975.96,
    76112.40,
    75259.63,
    74417.50,
    73585.87,
    72764.59,
    71953.52,
    71152.52,
    70361.46,
    69580.20,
    68808.60,
    68046.54,
    67293.88,
    66550.51,
    65816.29,
    65091.10,
    64374.81,
    63667.32,
    62968.49,
    62278.22,
    61596.39,
    60922.88,
    60257.59,
    59600.40,
    58951.21,
    58309.91,
    57676.39,
    57050.55,
    56432.29,
    55821.51,
    55218.10,
    54621.98,
    54033.04,
    53451.19,
    52876.33,
    52308.38,
    51747.24,
    51192.82,
    50645.04,
    50103.80,
    49569.02,
    49040.62,
    48518.52,
    48002.62,
    47492.85,
    46989.13,
    46491.38,
    45999.53,
    45513.49,
    45033.19,
    44558.56,
    44089.52,
    43626.00,
    43167.93,
    42715.23,
    42267.85,
    41825.71,
    41388.73,
    40956.87,
    40530.05,
    40108.20,
    39691.27,
    39279.18,
    38871.89,
    38469.32,
    38071.41,
    37678.12,
    37289.37,
    36905.11,
    36525.28,
    36149.83,
    35778.70,
    35411.84,
    35049.19,
    34690.71,
    34336.32,
    33986.00,
    33639.67,
    33297.31,
    32958.84,
    32624.23,
    32293.43,
    31966.38,
    31643.05,
    31323.39,
    31007.34,
    30694.87,
    30385.93,
    30080.47,
    29778.46,
    29479.85,
    29184.60,
    28892.66,
    28604.00,
    28318.58,
    28036.35,
    27757.27,
    27481.31,
    27208.44,
    26938.60,
    26671.76,
    26407.89,
    26146.95,
    25888.91,
    25633.72,
    25381.36,
    25131.79,
    24884.97,
    24640.88,
    24399.47,
    24160.73,
    23924.60,
    23691.07,
    23460.10,
    23231.65,
    23005.71,
    22782.24,
    22561.20,
    22342.58,
    22126.34,
    21912.45,
    21700.88,
    21491.61,
    21284.61,
    21079.85,
    20877.31,
    20676.95,
    20478.76,
    20282.70,
    20088.76,
    19896.90,
    19707.10,
    19519.34,
    19333.59,
    19149.83,
    18968.04,
    18788.19,
    18610.26,
    18434.22,
    18260.06,
    18087.75,
    17917.28,
    17748.61,
    17581.73,
    17416.61,
    17253.25,
    17091.60,
    16931.67,
    16773.42,
    16616.83,
    16461.90,
    16308.59,
    16156.89,
    16006.78,
    15858.24,
    15711.26,
    15565.81,
    15421.87,
    15279.44,
    15138.50,
    14999.01,
    14860.98,
    14724.38,
    14589.20,
    14455.41,
    14323.01,
    14191.98,
    14062.30,
    13933.95,
    13806.93,
    13681.22,
    13556.79,
    13433.65,
    13311.76,
    13191.13,
    13071.73,
    12953.54,
    12836.57,
    12720.79,
    12606.18,
    12492.75,
    12380.46,
    12269.32,
    12159.30,
    12050.40,
    11942.59,
    11835.88,
    11730.25,
    11625.68,
    11522.16,
    11419.69,
    11318.24,
    11217.82,
    11118.40,
    11019.98,
    10922.54,
    10826.07,
    10730.57,
    10636.03,
    10542.42,
    10449.75,
    10358.00,
    10267.15,
    10177.22,
    10088.17,
    10000.00,
    9912.71,
    9826.27,
    9740.69,
    9655.96,
    9572.05,
    9488.98,
    9406.72,
    9325.26,
    9244.61,
    9164.74,
    9085.66,
    9007.35,
    8929.80,
    8853.01,
    8776.97,
    8701.67,
    8627.10,
    8553.25,
    8480.12,
    8407.70,
    8335.98,
    8264.95,
    8194.61,
    8124.95,
    8055.96,
    7987.63,
    7919.96,
    7852.94,
    7786.56,
    7720.82,
    7655.71,
    7591.22,
    7527.35,
    7464.09,
    7401.43,
    7339.37,
    7277.89,
    7217.00,
    7156.69,
    7096.96,
    7037.78,
    6979.17,
    6921.11,
    6863.60,
    6806.64,
    6750.21,
    6694.31,
    6638.93,
    6584.08,
    6529.74,
    6475.91,
    6422.59,
    6369.76,
    6317.43,
    6265.58,
    6214.22,
    6163.34,
    6112.93,
    6062.99,
    6013.51,
    5964.50,
    5915.93,
    5867.82,
    5820.15,
    5772.92,
    5726.13,
    5679.76,
    5633.83,
    5588.32,
    5543.22,
    5498.54,
    5454.27,
    5410.41,
    5366.94,
    5323.88,
    5281.21,
    5238.92,
    5197.02,
    5155.51,
    5114.37,
    5073.60,
    5033.21,
    4993.18,
    4953.51,
    4914.20,
    4875.25,
    4836.65,
    4798.39,
    4760.48,
    4722.92,
    4685.69,
    4648.79,
    4612.23,
    4575.99,
    4540.08,
    4504.49,
    4469.22,
    4434.26,
    4399.61,
    4365.27,
    4331.24,
    4297.51,
    4264.08,
    4230.95,
    4198.11,
    4165.56,
    4133.30,
    4101.32,
    4069.63,
    4038.21,
    4007.07,
    3976.21,
    3945.62,
    3915.29,
    3885.23,
    3855.44,
    3825.91,
    3796.63,
    3767.61,
    3738.84,
    3710.33,
    3682.06,
    3654.04,
    3626.26,
    3598.72,
    3571.43,
    3544.37,
    3517.54,
    3490.94,
    3464.58,
    3438.44,
    3412.53,
    3386.84,
    3361.37,
    3336.12,
    3311.09,
    3286.27,
    3261.66,
    3237.27,
    3213.08,
    3189.11,
    3165.33,
    3141.76,
    3118.39,
    3095.22,
    3072.24,
    3049.46,
    3026.87,
    3004.48,
    2982.27,
    2960.25,
    2938.42,
    2916.77,
    2895.31,
    2874.02,
    2852.92,
    2831.99,
    2811.24,
    2790.66,
    2770.26,
    2750.02,
    2729.96,
    2710.06,
    2690.33,
    2670.76,
    2651.36,
    2632.12,
    2613.03,
    2594.11,
    2575.34,
    2556.73,
    2538.28,
    2519.97,
    2501.82,
    2483.82,
    2465.96,
    2448.26,
    2430.69,
    2413.28,
    2396.00,
    2378.87,
    2361.88,
    2345.03,
    2328.31,
    2311.74,
    2295.29,
    2278.99,
    2262.81,
    2246.77,
    2230.85,
    2215.07,
    2199.42,
    2183.89,
    2168.49,
    2153.21,
    2138.05,
    2123.02,
    2108.11,
    2093.32,
    2078.65,
    2064.10,
    2049.66,
    2035.35,
    2021.14,
    2007.05,
    1993.07,
    1979.21,
    1965.45,
    1951.81,
    1938.27,
    1924.84,
    1911.52,
    1898.30,
    1885.19,
    1872.19,
    1859.29,
    1846.48,
    1833.79,
    1821.19,
    1808.69,
    1796.29,
    1783.98,
    1771.78,
    1759.67,
    1747.65,
    1735.73,
    1723.91,
    1712.17,
    1700.53,
    1688.98,
    1677.52,
    1666.15,
    1654.87,
    1643.67,
    1632.56,
    1621.54,
    1610.61,
    1599.76,
    1588.99,
    1578.31,
    1567.71,
    1557.19,
    1546.76,
    1536.40,
    1526.13,
    1515.93,
    1505.81,
    1495.77,
    1485.81,
    1475.92,
    1466.11,
    1456.38,
    1446.72,
    1437.13,
    1427.62,
    1418.17,
    1408.81,
    1399.51,
    1390.28,
    1381.12,
    1372.04,
    1363.02,
    1354.07,
    1345.19,
    1336.37,
    1327.62,
    1318.94,
    1310.33,
    1301.77,
    1293.29,
    1284.87,
    1276.51,
    1268.21,
    1259.97,
    1251.80,
    1243.69,
    1235.64,
    1227.65,
    1219.72,
    1211.85,
    1204.03,
    1196.28,
    1188.58,
    1180.94,
    1173.36,
    1165.83,
    1158.36,
    1150.94,
    1143.58,
    1136.28,
    1129.02,
    1121.83,
    1114.68,
    1107.59,
    1100.55,
    1093.56,
    1086.62,
    1079.73,
    1072.90,
    1066.11,
    1059.37,
    1052.69,
    1046.05,
    1039.46,
    1032.91,
    1026.42,
    1019.97,
    1013.57,
    1007.22,
    1000.91,
    994.65,
    988.43,
    982.26,
    976.14,
    970.05,
    964.02,
    958.02,
    952.07,
    946.16,
    940.29,
    934.47,
    928.69,
    922.94,
    917.24,
    911.59,
    905.97,
    900.39,
    894.85,
    889.35,
    883.89,
    878.47,
    873.09,
    867.74,
    862.44,
    857.17,
    851.94,
    846.74,
    841.59,
    836.46,
    831.38,
    826.33,
    821.32,
    816.34,
    811.40,
    806.49,
    801.61,
    796.77,
    791.97,
    787.20,
    782.46,
    777.75,
    773.08,
    768.44,
    763.83,
    759.26,
    754.71,
    750.20,
    745.72,
    741.27,
    736.85,
    732.46,
    728.10,
    723.78,
    719.48,
    715.21,
    710.97,
    706.76,
    702.58,
    698.43,
    694.31,
    690.21,
    686.14,
    682.11,
    678.09,
    674.11,
    670.15,
    666.22,
    662.32,
    658.45,
    654.60,
    650.77,
    646.97,
    643.20,
    639.46,
    635.74,
    632.04,
    628.37,
    624.72,
    621.10,
    617.51,
    613.93,
    610.39,
    606.86,
    603.36,
    599.88,
    596.43,
    593.00,
    589.59,
    586.21,
    582.84,
    579.51,
    576.19,
    572.89,
    569.62,
    566.37,
    563.14,
    559.93,
    556.74,
    553.58,
    550.43,
    547.31,
    544.20,
    541.12,
    538.06,
    535.02,
    532.00,
    528.99,
    526.01,
    523.05,
    520.10,
    517.18,
    514.28,
    511.39,
    508.52,
    505.68,
    502.85,
    500.04,
    497.24,
    494.47,
    491.71,
    488.97,
    486.25,
    483.55,
    480.86,
    478.20,
    475.55,
    472.91,
    470.30,
    467.70,
    465.11,
    462.55,
    460.00,
    457.47,
    454.95,
    452.45,
    449.96,
    447.50,
    445.04,
    442.61,
    440.19,
    437.78,
    435.39,
    433.01,
    430.65,
    428.31,
    425.98,
    423.66,
    421.36,
    419.08,
    416.81,
    414.55,
    412.31,
    410.08,
    407.87,
    405.67,
    403.48,
    401.31,
    399.15,
    397.00,
    394.87,
    392.75,
    390.65,
    388.56,
    386.48,
    384.41,
    382.36,
    380.32,
    378.29,
    376.28,
    374.28,
    372.29,
    370.31,
    368.34,
    366.39,
    364.45,
    362.52,
    360.61,
    358.70,
    356.81,
    354.93,
    353.06,
    351.20,
    349.36,
    347.52,
    345.70,
    343.89,
    342.09,
    340.29,
    338.52,
    336.75])

    x = res_NTC
    y = T_NTC
    f2 = interp1d(x,y, kind = 'cubic')
    return f2(res)

def R_from_T(temperature):
    T_NTC = np.array([-40.0,
    -39.8,
    -39.6,
    -39.4,
    -39.2,
    -39.0,
    -38.8,
    -38.6,
    -38.4,
    -38.2,
    -38.0,
    -37.8,
    -37.6,
    -37.4,
    -37.2,
    -37.0,
    -36.8,
    -36.6,
    -36.4,
    -36.2,
    -36.0,
    -35.8,
    -35.6,
    -35.4,
    -35.2,
    -35.0,
    -34.8,
    -34.6,
    -34.4,
    -34.2,
    -34.0,
    -33.8,
    -33.6,
    -33.4,
    -33.2,
    -33.0,
    -32.8,
    -32.6,
    -32.4,
    -32.2,
    -32.0,
    -31.8,
    -31.6,
    -31.4,
    -31.2,
    -31.0,
    -30.8,
    -30.6,
    -30.4,
    -30.2,
    -30.0,
    -29.8,
    -29.6,
    -29.4,
    -29.2,
    -29.0,
    -28.8,
    -28.6,
    -28.4,
    -28.2,
    -28.0,
    -27.8,
    -27.6,
    -27.4,
    -27.2,
    -27.0,
    -26.8,
    -26.6,
    -26.4,
    -26.2,
    -26.0,
    -25.8,
    -25.6,
    -25.4,
    -25.2,
    -25.0,
    -24.8,
    -24.6,
    -24.4,
    -24.2,
    -24.0,
    -23.8,
    -23.6,
    -23.4,
    -23.2,
    -23.0,
    -22.8,
    -22.6,
    -22.4,
    -22.2,
    -22.0,
    -21.8,
    -21.6,
    -21.4,
    -21.2,
    -21.0,
    -20.8,
    -20.6,
    -20.4,
    -20.2,
    -20.0,
    -19.8,
    -19.6,
    -19.4,
    -19.2,
    -19.0,
    -18.8,
    -18.6,
    -18.4,
    -18.2,
    -18.0,
    -17.8,
    -17.6,
    -17.4,
    -17.2,
    -17.0,
    -16.8,
    -16.6,
    -16.4,
    -16.2,
    -16.0,
    -15.8,
    -15.6,
    -15.4,
    -15.2,
    -15.0,
    -14.8,
    -14.6,
    -14.4,
    -14.2,
    -14.0,
    -13.8,
    -13.6,
    -13.4,
    -13.2,
    -13.0,
    -12.8,
    -12.6,
    -12.4,
    -12.2,
    -12.0,
    -11.8,
    -11.6,
    -11.4,
    -11.2,
    -11.0,
    -10.8,
    -10.6,
    -10.4,
    -10.2,
    -10.0,
    -9.8,
    -9.6,
    -9.4,
    -9.2,
    -9.0,
    -8.8,
    -8.6,
    -8.4,
    -8.2,
    -8.0,
    -7.8,
    -7.6,
    -7.4,
    -7.2,
    -7.0,
    -6.8,
    -6.6,
    -6.4,
    -6.2,
    -6.0,
    -5.8,
    -5.6,
    -5.4,
    -5.2,
    -5.0,
    -4.8,
    -4.6,
    -4.4,
    -4.2,
    -4.0,
    -3.8,
    -3.6,
    -3.4,
    -3.2,
    -3.0,
    -2.8,
    -2.6,
    -2.4,
    -2.2,
    -2.0,
    -1.8,
    -1.6,
    -1.4,
    -1.2,
    -1.0,
    -0.8,
    -0.6,
    -0.4,
    -0.2,
    0.0,
    0.2,
    0.4,
    0.6,
    0.8,
    1.0,
    1.2,
    1.4,
    1.6,
    1.8,
    2.0,
    2.2,
    2.4,
    2.6,
    2.8,
    3.0,
    3.2,
    3.4,
    3.6,
    3.8,
    4.0,
    4.2,
    4.4,
    4.6,
    4.8,
    5.0,
    5.2,
    5.4,
    5.6,
    5.8,
    6.0,
    6.2,
    6.4,
    6.6,
    6.8,
    7.0,
    7.2,
    7.4,
    7.6,
    7.8,
    8.0,
    8.2,
    8.4,
    8.6,
    8.8,
    9.0,
    9.2,
    9.4,
    9.6,
    9.8,
    10.0,
    10.2,
    10.4,
    10.6,
    10.8,
    11.0,
    11.2,
    11.4,
    11.6,
    11.8,
    12.0,
    12.2,
    12.4,
    12.6,
    12.8,
    13.0,
    13.2,
    13.4,
    13.6,
    13.8,
    14.0,
    14.2,
    14.4,
    14.6,
    14.8,
    15.0,
    15.2,
    15.4,
    15.6,
    15.8,
    16.0,
    16.2,
    16.4,
    16.6,
    16.8,
    17.0,
    17.2,
    17.4,
    17.6,
    17.8,
    18.0,
    18.2,
    18.4,
    18.6,
    18.8,
    19.0,
    19.2,
    19.4,
    19.6,
    19.8,
    20.0,
    20.2,
    20.4,
    20.6,
    20.8,
    21.0,
    21.2,
    21.4,
    21.6,
    21.8,
    22.0,
    22.2,
    22.4,
    22.6,
    22.8,
    23.0,
    23.2,
    23.4,
    23.6,
    23.8,
    24.0,
    24.2,
    24.4,
    24.6,
    24.8,
    25.0,
    25.2,
    25.4,
    25.6,
    25.8,
    26.0,
    26.2,
    26.4,
    26.6,
    26.8,
    27.0,
    27.2,
    27.4,
    27.6,
    27.8,
    28.0,
    28.2,
    28.4,
    28.6,
    28.8,
    29.0,
    29.2,
    29.4,
    29.6,
    29.8,
    30.0,
    30.2,
    30.4,
    30.6,
    30.8,
    31.0,
    31.2,
    31.4,
    31.6,
    31.8,
    32.0,
    32.2,
    32.4,
    32.6,
    32.8,
    33.0,
    33.2,
    33.4,
    33.6,
    33.8,
    34.0,
    34.2,
    34.4,
    34.6,
    34.8,
    35.0,
    35.2,
    35.4,
    35.6,
    35.8,
    36.0,
    36.2,
    36.4,
    36.6,
    36.8,
    37.0,
    37.2,
    37.4,
    37.6,
    37.8,
    38.0,
    38.2,
    38.4,
    38.6,
    38.8,
    39.0,
    39.2,
    39.4,
    39.6,
    39.8,
    40.0,
    40.2,
    40.4,
    40.6,
    40.8,
    41.0,
    41.2,
    41.4,
    41.6,
    41.8,
    42.0,
    42.2,
    42.4,
    42.6,
    42.8,
    43.0,
    43.2,
    43.4,
    43.6,
    43.8,
    44.0,
    44.2,
    44.4,
    44.6,
    44.8,
    45.0,
    45.2,
    45.4,
    45.6,
    45.8,
    46.0,
    46.2,
    46.4,
    46.6,
    46.8,
    47.0,
    47.2,
    47.4,
    47.6,
    47.8,
    48.0,
    48.2,
    48.4,
    48.6,
    48.8,
    49.0,
    49.2,
    49.4,
    49.6,
    49.8,
    50.0,
    50.2,
    50.4,
    50.6,
    50.8,
    51.0,
    51.2,
    51.4,
    51.6,
    51.8,
    52.0,
    52.2,
    52.4,
    52.6,
    52.8,
    53.0,
    53.2,
    53.4,
    53.6,
    53.8,
    54.0,
    54.2,
    54.4,
    54.6,
    54.8,
    55.0,
    55.2,
    55.4,
    55.6,
    55.8,
    56.0,
    56.2,
    56.4,
    56.6,
    56.8,
    57.0,
    57.2,
    57.4,
    57.6,
    57.8,
    58.0,
    58.2,
    58.4,
    58.6,
    58.8,
    59.0,
    59.2,
    59.4,
    59.6,
    59.8,
    60.0,
    60.2,
    60.4,
    60.6,
    60.8,
    61.0,
    61.2,
    61.4,
    61.6,
    61.8,
    62.0,
    62.2,
    62.4,
    62.6,
    62.8,
    63.0,
    63.2,
    63.4,
    63.6,
    63.8,
    64.0,
    64.2,
    64.4,
    64.6,
    64.8,
    65.0,
    65.2,
    65.4,
    65.6,
    65.8,
    66.0,
    66.2,
    66.4,
    66.6,
    66.8,
    67.0,
    67.2,
    67.4,
    67.6,
    67.8,
    68.0,
    68.2,
    68.4,
    68.6,
    68.8,
    69.0,
    69.2,
    69.4,
    69.6,
    69.8,
    70.0,
    70.2,
    70.4,
    70.6,
    70.8,
    71.0,
    71.2,
    71.4,
    71.6,
    71.8,
    72.0,
    72.2,
    72.4,
    72.6,
    72.8,
    73.0,
    73.2,
    73.4,
    73.6,
    73.8,
    74.0,
    74.2,
    74.4,
    74.6,
    74.8,
    75.0,
    75.2,
    75.4,
    75.6,
    75.8,
    76.0,
    76.2,
    76.4,
    76.6,
    76.8,
    77.0,
    77.2,
    77.4,
    77.6,
    77.8,
    78.0,
    78.2,
    78.4,
    78.6,
    78.8,
    79.0,
    79.2,
    79.4,
    79.6,
    79.8,
    80.0,
    80.2,
    80.4,
    80.6,
    80.8,
    81.0,
    81.2,
    81.4,
    81.6,
    81.8,
    82.0,
    82.2,
    82.4,
    82.6,
    82.8,
    83.0,
    83.2,
    83.4,
    83.6,
    83.8,
    84.0,
    84.2,
    84.4,
    84.6,
    84.8,
    85.0,
    85.2,
    85.4,
    85.6,
    85.8,
    86.0,
    86.2,
    86.4,
    86.6,
    86.8,
    87.0,
    87.2,
    87.4,
    87.6,
    87.8,
    88.0,
    88.2,
    88.4,
    88.6,
    88.8,
    89.0,
    89.2,
    89.4,
    89.6,
    89.8,
    90.0,
    90.2,
    90.4,
    90.6,
    90.8,
    91.0,
    91.2,
    91.4,
    91.6,
    91.8,
    92.0,
    92.2,
    92.4,
    92.6,
    92.8,
    93.0,
    93.2,
    93.4,
    93.6,
    93.8,
    94.0,
    94.2,
    94.4,
    94.6,
    94.8,
    95.0,
    95.2,
    95.4,
    95.6,
    95.8,
    96.0,
    96.2,
    96.4,
    96.6,
    96.8,
    97.0,
    97.2,
    97.4,
    97.6,
    97.8,
    98.0,
    98.2,
    98.4,
    98.6,
    98.8,
    99.0,
    99.2,
    99.4,
    99.6,
    99.8,
    100.0,
    100.2,
    100.4,
    100.6,
    100.8,
    101.0,
    101.2,
    101.4,
    101.6,
    101.8,
    102.0,
    102.2,
    102.4,
    102.6,
    102.8,
    103.0,
    103.2,
    103.4,
    103.6,
    103.8,
    104.0,
    104.2,
    104.4,
    104.6,
    104.8,
    105.0,
    105.2,
    105.4,
    105.6,
    105.8,
    106.0,
    106.2,
    106.4,
    106.6,
    106.8,
    107.0,
    107.2,
    107.4,
    107.6,
    107.8,
    108.0,
    108.2,
    108.4,
    108.6,
    108.8,
    109.0,
    109.2,
    109.4,
    109.6,
    109.8,
    110.0,
    110.2,
    110.4,
    110.6,
    110.8,
    111.0,
    111.2,
    111.4,
    111.6,
    111.8,
    112.0,
    112.2,
    112.4,
    112.6,
    112.8,
    113.0,
    113.2,
    113.4,
    113.6,
    113.8,
    114.0,
    114.2,
    114.4,
    114.6,
    114.8,
    115.0,
    115.2,
    115.4,
    115.6,
    115.8,
    116.0,
    116.2,
    116.4,
    116.6,
    116.8,
    117.0,
    117.2,
    117.4,
    117.6,
    117.8,
    118.0,
    118.2,
    118.4,
    118.6,
    118.8,
    119.0,
    119.2,
    119.4,
    119.6,
    119.8,
    120.0,
    120.2,
    120.4,
    120.6,
    120.8,
    121.0,
    121.2,
    121.4,
    121.6,
    121.8,
    122.0,
    122.2,
    122.4,
    122.6,
    122.8,
    123.0,
    123.2,
    123.4,
    123.6,
    123.8,
    124.0,
    124.2,
    124.4,
    124.6,
    124.8,
    125.0])
    
    res_NTC = np.array([334274.4,
    329874.7,
    325538.8,
    321265.8,
    317054.7,
    312904.4,
    308814.1,
    304782.8,
    300809.5,
    296893.4,
    293033.6,
    289229.1,
    285479.2,
    281782.9,
    278139.4,
    274548.0,
    271007.8,
    267517.9,
    264077.7,
    260686.4,
    257343.1,
    254047.2,
    250798.0,
    247594.6,
    244436.5,
    241322.9,
    238253.1,
    235226.4,
    232242.2,
    229299.9,
    226398.8,
    223538.3,
    220717.7,
    217936.5,
    215194.00,
    212489.69,
    209822.96,
    207193.24,
    204599.98,
    202042.63,
    199520.64,
    197033.47,
    194580.61,
    192161.54,
    189775.75,
    187422.75,
    185102.03,
    182813.13,
    180555.55,
    178328.84,
    176132.54,
    173966.18,
    171829.33,
    169721.55,
    167642.41,
    165591.47,
    163568.34,
    161572.58,
    159603.80,
    157661.60,
    155745.60,
    153855.39,
    151990.61,
    150150.88,
    148335.83,
    146545.11,
    144778.35,
    143035.21,
    141315.34,
    139618.40,
    137944.05,
    136291.98,
    134661.85,
    133053.35,
    131466.17,
    129899.99,
    128354.51,
    126829.43,
    125324.47,
    123839.32,
    122373.70,
    120927.34,
    119499.95,
    118091.27,
    116701.03,
    115328.95,
    113974.79,
    112638.29,
    111319.19,
    110017.26,
    108732.23,
    107463.88,
    106211.96,
    104976.25,
    103756.51,
    102552.53,
    101364.06,
    100190.91,
    99032.85,
    97889.66,
    96761.15,
    95647.10,
    94547.31,
    93461.58,
    92389.72,
    91331.53,
    90286.81,
    89255.39,
    88237.08,
    87231.69,
    86239.05,
    85258.97,
    84291.29,
    83335.83,
    82392.43,
    81460.91,
    80541.11,
    79632.88,
    78736.04,
    77850.46,
    76975.96,
    76112.40,
    75259.63,
    74417.50,
    73585.87,
    72764.59,
    71953.52,
    71152.52,
    70361.46,
    69580.20,
    68808.60,
    68046.54,
    67293.88,
    66550.51,
    65816.29,
    65091.10,
    64374.81,
    63667.32,
    62968.49,
    62278.22,
    61596.39,
    60922.88,
    60257.59,
    59600.40,
    58951.21,
    58309.91,
    57676.39,
    57050.55,
    56432.29,
    55821.51,
    55218.10,
    54621.98,
    54033.04,
    53451.19,
    52876.33,
    52308.38,
    51747.24,
    51192.82,
    50645.04,
    50103.80,
    49569.02,
    49040.62,
    48518.52,
    48002.62,
    47492.85,
    46989.13,
    46491.38,
    45999.53,
    45513.49,
    45033.19,
    44558.56,
    44089.52,
    43626.00,
    43167.93,
    42715.23,
    42267.85,
    41825.71,
    41388.73,
    40956.87,
    40530.05,
    40108.20,
    39691.27,
    39279.18,
    38871.89,
    38469.32,
    38071.41,
    37678.12,
    37289.37,
    36905.11,
    36525.28,
    36149.83,
    35778.70,
    35411.84,
    35049.19,
    34690.71,
    34336.32,
    33986.00,
    33639.67,
    33297.31,
    32958.84,
    32624.23,
    32293.43,
    31966.38,
    31643.05,
    31323.39,
    31007.34,
    30694.87,
    30385.93,
    30080.47,
    29778.46,
    29479.85,
    29184.60,
    28892.66,
    28604.00,
    28318.58,
    28036.35,
    27757.27,
    27481.31,
    27208.44,
    26938.60,
    26671.76,
    26407.89,
    26146.95,
    25888.91,
    25633.72,
    25381.36,
    25131.79,
    24884.97,
    24640.88,
    24399.47,
    24160.73,
    23924.60,
    23691.07,
    23460.10,
    23231.65,
    23005.71,
    22782.24,
    22561.20,
    22342.58,
    22126.34,
    21912.45,
    21700.88,
    21491.61,
    21284.61,
    21079.85,
    20877.31,
    20676.95,
    20478.76,
    20282.70,
    20088.76,
    19896.90,
    19707.10,
    19519.34,
    19333.59,
    19149.83,
    18968.04,
    18788.19,
    18610.26,
    18434.22,
    18260.06,
    18087.75,
    17917.28,
    17748.61,
    17581.73,
    17416.61,
    17253.25,
    17091.60,
    16931.67,
    16773.42,
    16616.83,
    16461.90,
    16308.59,
    16156.89,
    16006.78,
    15858.24,
    15711.26,
    15565.81,
    15421.87,
    15279.44,
    15138.50,
    14999.01,
    14860.98,
    14724.38,
    14589.20,
    14455.41,
    14323.01,
    14191.98,
    14062.30,
    13933.95,
    13806.93,
    13681.22,
    13556.79,
    13433.65,
    13311.76,
    13191.13,
    13071.73,
    12953.54,
    12836.57,
    12720.79,
    12606.18,
    12492.75,
    12380.46,
    12269.32,
    12159.30,
    12050.40,
    11942.59,
    11835.88,
    11730.25,
    11625.68,
    11522.16,
    11419.69,
    11318.24,
    11217.82,
    11118.40,
    11019.98,
    10922.54,
    10826.07,
    10730.57,
    10636.03,
    10542.42,
    10449.75,
    10358.00,
    10267.15,
    10177.22,
    10088.17,
    10000.00,
    9912.71,
    9826.27,
    9740.69,
    9655.96,
    9572.05,
    9488.98,
    9406.72,
    9325.26,
    9244.61,
    9164.74,
    9085.66,
    9007.35,
    8929.80,
    8853.01,
    8776.97,
    8701.67,
    8627.10,
    8553.25,
    8480.12,
    8407.70,
    8335.98,
    8264.95,
    8194.61,
    8124.95,
    8055.96,
    7987.63,
    7919.96,
    7852.94,
    7786.56,
    7720.82,
    7655.71,
    7591.22,
    7527.35,
    7464.09,
    7401.43,
    7339.37,
    7277.89,
    7217.00,
    7156.69,
    7096.96,
    7037.78,
    6979.17,
    6921.11,
    6863.60,
    6806.64,
    6750.21,
    6694.31,
    6638.93,
    6584.08,
    6529.74,
    6475.91,
    6422.59,
    6369.76,
    6317.43,
    6265.58,
    6214.22,
    6163.34,
    6112.93,
    6062.99,
    6013.51,
    5964.50,
    5915.93,
    5867.82,
    5820.15,
    5772.92,
    5726.13,
    5679.76,
    5633.83,
    5588.32,
    5543.22,
    5498.54,
    5454.27,
    5410.41,
    5366.94,
    5323.88,
    5281.21,
    5238.92,
    5197.02,
    5155.51,
    5114.37,
    5073.60,
    5033.21,
    4993.18,
    4953.51,
    4914.20,
    4875.25,
    4836.65,
    4798.39,
    4760.48,
    4722.92,
    4685.69,
    4648.79,
    4612.23,
    4575.99,
    4540.08,
    4504.49,
    4469.22,
    4434.26,
    4399.61,
    4365.27,
    4331.24,
    4297.51,
    4264.08,
    4230.95,
    4198.11,
    4165.56,
    4133.30,
    4101.32,
    4069.63,
    4038.21,
    4007.07,
    3976.21,
    3945.62,
    3915.29,
    3885.23,
    3855.44,
    3825.91,
    3796.63,
    3767.61,
    3738.84,
    3710.33,
    3682.06,
    3654.04,
    3626.26,
    3598.72,
    3571.43,
    3544.37,
    3517.54,
    3490.94,
    3464.58,
    3438.44,
    3412.53,
    3386.84,
    3361.37,
    3336.12,
    3311.09,
    3286.27,
    3261.66,
    3237.27,
    3213.08,
    3189.11,
    3165.33,
    3141.76,
    3118.39,
    3095.22,
    3072.24,
    3049.46,
    3026.87,
    3004.48,
    2982.27,
    2960.25,
    2938.42,
    2916.77,
    2895.31,
    2874.02,
    2852.92,
    2831.99,
    2811.24,
    2790.66,
    2770.26,
    2750.02,
    2729.96,
    2710.06,
    2690.33,
    2670.76,
    2651.36,
    2632.12,
    2613.03,
    2594.11,
    2575.34,
    2556.73,
    2538.28,
    2519.97,
    2501.82,
    2483.82,
    2465.96,
    2448.26,
    2430.69,
    2413.28,
    2396.00,
    2378.87,
    2361.88,
    2345.03,
    2328.31,
    2311.74,
    2295.29,
    2278.99,
    2262.81,
    2246.77,
    2230.85,
    2215.07,
    2199.42,
    2183.89,
    2168.49,
    2153.21,
    2138.05,
    2123.02,
    2108.11,
    2093.32,
    2078.65,
    2064.10,
    2049.66,
    2035.35,
    2021.14,
    2007.05,
    1993.07,
    1979.21,
    1965.45,
    1951.81,
    1938.27,
    1924.84,
    1911.52,
    1898.30,
    1885.19,
    1872.19,
    1859.29,
    1846.48,
    1833.79,
    1821.19,
    1808.69,
    1796.29,
    1783.98,
    1771.78,
    1759.67,
    1747.65,
    1735.73,
    1723.91,
    1712.17,
    1700.53,
    1688.98,
    1677.52,
    1666.15,
    1654.87,
    1643.67,
    1632.56,
    1621.54,
    1610.61,
    1599.76,
    1588.99,
    1578.31,
    1567.71,
    1557.19,
    1546.76,
    1536.40,
    1526.13,
    1515.93,
    1505.81,
    1495.77,
    1485.81,
    1475.92,
    1466.11,
    1456.38,
    1446.72,
    1437.13,
    1427.62,
    1418.17,
    1408.81,
    1399.51,
    1390.28,
    1381.12,
    1372.04,
    1363.02,
    1354.07,
    1345.19,
    1336.37,
    1327.62,
    1318.94,
    1310.33,
    1301.77,
    1293.29,
    1284.87,
    1276.51,
    1268.21,
    1259.97,
    1251.80,
    1243.69,
    1235.64,
    1227.65,
    1219.72,
    1211.85,
    1204.03,
    1196.28,
    1188.58,
    1180.94,
    1173.36,
    1165.83,
    1158.36,
    1150.94,
    1143.58,
    1136.28,
    1129.02,
    1121.83,
    1114.68,
    1107.59,
    1100.55,
    1093.56,
    1086.62,
    1079.73,
    1072.90,
    1066.11,
    1059.37,
    1052.69,
    1046.05,
    1039.46,
    1032.91,
    1026.42,
    1019.97,
    1013.57,
    1007.22,
    1000.91,
    994.65,
    988.43,
    982.26,
    976.14,
    970.05,
    964.02,
    958.02,
    952.07,
    946.16,
    940.29,
    934.47,
    928.69,
    922.94,
    917.24,
    911.59,
    905.97,
    900.39,
    894.85,
    889.35,
    883.89,
    878.47,
    873.09,
    867.74,
    862.44,
    857.17,
    851.94,
    846.74,
    841.59,
    836.46,
    831.38,
    826.33,
    821.32,
    816.34,
    811.40,
    806.49,
    801.61,
    796.77,
    791.97,
    787.20,
    782.46,
    777.75,
    773.08,
    768.44,
    763.83,
    759.26,
    754.71,
    750.20,
    745.72,
    741.27,
    736.85,
    732.46,
    728.10,
    723.78,
    719.48,
    715.21,
    710.97,
    706.76,
    702.58,
    698.43,
    694.31,
    690.21,
    686.14,
    682.11,
    678.09,
    674.11,
    670.15,
    666.22,
    662.32,
    658.45,
    654.60,
    650.77,
    646.97,
    643.20,
    639.46,
    635.74,
    632.04,
    628.37,
    624.72,
    621.10,
    617.51,
    613.93,
    610.39,
    606.86,
    603.36,
    599.88,
    596.43,
    593.00,
    589.59,
    586.21,
    582.84,
    579.51,
    576.19,
    572.89,
    569.62,
    566.37,
    563.14,
    559.93,
    556.74,
    553.58,
    550.43,
    547.31,
    544.20,
    541.12,
    538.06,
    535.02,
    532.00,
    528.99,
    526.01,
    523.05,
    520.10,
    517.18,
    514.28,
    511.39,
    508.52,
    505.68,
    502.85,
    500.04,
    497.24,
    494.47,
    491.71,
    488.97,
    486.25,
    483.55,
    480.86,
    478.20,
    475.55,
    472.91,
    470.30,
    467.70,
    465.11,
    462.55,
    460.00,
    457.47,
    454.95,
    452.45,
    449.96,
    447.50,
    445.04,
    442.61,
    440.19,
    437.78,
    435.39,
    433.01,
    430.65,
    428.31,
    425.98,
    423.66,
    421.36,
    419.08,
    416.81,
    414.55,
    412.31,
    410.08,
    407.87,
    405.67,
    403.48,
    401.31,
    399.15,
    397.00,
    394.87,
    392.75,
    390.65,
    388.56,
    386.48,
    384.41,
    382.36,
    380.32,
    378.29,
    376.28,
    374.28,
    372.29,
    370.31,
    368.34,
    366.39,
    364.45,
    362.52,
    360.61,
    358.70,
    356.81,
    354.93,
    353.06,
    351.20,
    349.36,
    347.52,
    345.70,
    343.89,
    342.09,
    340.29,
    338.52,
    336.75])

    x = res_NTC
    y = T_NTC
    f2 = interp1d(y,x, kind = 'cubic')
    return f2(temperature)

def fit_expo_model(params, x):
    A = params['A'].value
    B = params['B'].value
    C = params['C'].value
    output = A*(np.exp(-x*B))+C
    return output
'''
define how to compare data to the function
'''
def fit_expo_fit(params , x, data, err):
    model = fit_expo_model(params , x)
    return (model - data)/err

if __name__ == "__main__":
    #print T_from_R(10000)
    print R_from_T(0)
    print R_from_T(100)
    print R_from_T(50)
    r3 =3300
    r2 =3300
    r1 =3300
    rth = R_from_T(30)
    #print 5.0*(r3/(r3+r1) - rth/(rth+r2))
    #data = np.loadtxt("LabVIEW_longterm_data_2018.txt", delimiter = ",")
    data = np.loadtxt("Newton_cooling_data_01.txt", delimiter = ",")
    #data_cold = np.loadtxt("LabVIEW_longterm_data_cold_2018.txt", delimiter = ",")
    skip = 2000
    time = data[:,0][skip:230000]
    voltage = data[:,1][skip:230000]

    '''
    v = 5(0.5 - r/r+3300)
    v = 2.5 - 5r/r+3300
    v(r+3300) = 2.5(r+3300) - 5r
    vr + v3300 = 2.5r + 2.5*3300 - 5r
    vr -2.5r + 5r = -3300v + 2.5*3300
    r(v+2.5) = -3300v + 2.5*3300
    r = 3300(2.5-v)/(2.5+v)
    '''
    resistance =  3300.0*(2.5-voltage)/(voltage+2.5)
    temperature = T_from_R(resistance)

    x = time
    y = temperature
    yerr = y*0.01

    params = lmfit.Parameters()
 
    params.add('A', value = 60.3170272, vary = True)
    params.add('B', value = 6.4940e-05, vary = True)
    params.add('C', value = 30.7804910, vary = True)
 
    result = lmfit.minimize(fit_expo_fit, params, args = (x, y, yerr))
 
    fit_values  = y + result.residual
 
    lmfit.report_errors(result.params)

    print result.redchi

    x_plot = np.linspace(x.min(),x.max(),1000)

    #temperature = temperature - result.params['C'].value

    figure = pyplot.figure(0)

    #print x
  
    #pyplot.errorbar(x,y2,yerr, linestyle='None',markersize = 4.0,fmt='o',color='blue')
    pyplot.plot(time/3600.0, temperature, 'ro', markersize=1.0)
    pyplot.plot(x_plot/3600.0,fit_expo_model(result.params,x_plot),linewidth = 4.0)

    #pyplot.yscale('log')
    #pyplot.yscale('log',basex=np.e,subsy=[2, 3, 4, 5, 6, 7, 8, 9])   
    pyplot.ylabel('T (degrees Celcius)')
    pyplot.xlabel('$t$ (hours)')
    #pyplot.ylim([0.00000005,0.001])


    pyplot.show()
